!function(){var t={};function e(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}function r(t,e,r){if(!e.has(t))throw TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}function n(t,e){var n=r(t,e,"get");return n.get?n.get.call(t):n.value}function a(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function i(t,e,r){a(t,e),e.set(t,r)}function o(t,e,n){var a=r(t,e,"set");return!function(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=r}}(t,a,n),n}function s(t,e,r){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return r}function u(t,e){a(t,e),e.add(t)}function l(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function c(t,e,r){return e&&l(t.prototype,e),r&&l(t,r),t}function f(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var v={};function h(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function d(t){return function(t){if(Array.isArray(t))return h(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return h(t,void 0);var r=Object.prototype.toString.call(t).slice(8,-1);if("Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return h(t,void 0)}}(t)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var g=new WeakMap,S=new WeakSet,y=function(){function t(r){e(this,t),u(this,S),i(this,g,{writable:!0,value:void 0}),o(this,g,r)}return c(t,[{key:"filterCells",value:function(t){var e=[],r=this.getState();for(var n in r)for(var a in r[n]){var i={x:a,y:n};t(r[n][a],i,r)&&e.push(i)}return e}},{key:"getState",value:function(){return d(n(this,g)).map(function(t){return d(t)})}},{key:"getMovedLeftState",value:function(){var t=[],e=[],r=this.getState(),n=!0,a=!1,i=void 0;try{for(var o,u=r[Symbol.iterator]();!(n=(o=u.next()).done);n=!0){var l=o.value,c=s(this,S,p).call(this,l),f=c.mergedValues,v=c.newAxis;t.push(v),e.push.apply(e,d(f))}}catch(t){a=!0,i=t}finally{try{n||null==u.return||u.return()}finally{if(a)throw i}}return{newState:t,mergedValues:e}}},{key:"getMovedRightState",value:function(){var t=[],e=[],r=this.getState(),n=!0,a=!1,i=void 0;try{for(var o,u=r[Symbol.iterator]();!(n=(o=u.next()).done);n=!0){var l=o.value,c=s(this,S,p).call(this,l.reverse()),f=c.mergedValues,v=c.newAxis;t.push(v.reverse()),e.push.apply(e,d(f))}}catch(t){a=!0,i=t}finally{try{n||null==u.return||u.return()}finally{if(a)throw i}}return{newState:t,mergedValues:e}}},{key:"getMovedUpState",value:function(){var t=this.getState(),e=[];for(var r in t){var n=[];for(var a in t[r])n.push(t[a][r]);var i=s(this,S,p).call(this,n),o=i.mergedValues,u=i.newAxis;for(var l in t[r])t[l][r]=u[l];e.push.apply(e,d(o))}return{newState:t,mergedValues:e}}},{key:"getMovedDownState",value:function(){var t=this.getState().reverse(),e=[];for(var r in t){var n=[];for(var a in t[r])n.push(t[a][r]);var i=s(this,S,p).call(this,n),o=i.mergedValues,u=i.newAxis;for(var l in t[r])t[l][r]=u[l];e.push.apply(e,d(o))}return{newState:t.reverse(),mergedValues:e}}}]),t}();function p(t){for(var e=t.filter(function(t){return 0!==t}),r=[],n=[],a=0;a<e.length;a++){var i=e[a],o=e[a+1];i===o&&(i+=o,n.push(i),a++),r.push(i)}for(;r.length<t.length;)r.push(0);return{newAxis:r,mergedValues:n}}f(y,"SIZE",4),v=y;var m={};m=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Math.floor(Math.random()*(t-e))+e};var w=new WeakMap,b=new WeakMap,k=new WeakMap,A=new WeakMap,M=new WeakSet,T=new WeakSet,L=new WeakSet,E=new WeakSet,U=function(){function t(r){e(this,t),u(this,M),u(this,T),u(this,L),u(this,E),i(this,w,{writable:!0,value:[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]}),i(this,b,{writable:!0,value:void 0}),i(this,k,{writable:!0,value:void 0}),i(this,A,{writable:!0,value:void 0}),o(this,w,null!=r?r:n(this,w)),this.restart()}return c(t,[{key:"moveLeft",value:function(){var t=this;s(this,M,V).call(this,function(){return n(t,b).getMovedLeftState()})}},{key:"moveRight",value:function(){var t=this;s(this,M,V).call(this,function(){return n(t,b).getMovedRightState()})}},{key:"moveUp",value:function(){var t=this;s(this,M,V).call(this,function(){return n(t,b).getMovedUpState()})}},{key:"moveDown",value:function(){var t=this;s(this,M,V).call(this,function(){return n(t,b).getMovedDownState()})}},{key:"getScore",value:function(){return n(this,k)}},{key:"getState",value:function(){return n(this,b).getState()}},{key:"getStatus",value:function(){return n(this,A)}},{key:"start",value:function(){o(this,A,t.STATUSES.playing);for(var e=2;e>0;e--)s(this,E,O).call(this)}},{key:"restart",value:function(){o(this,A,t.STATUSES.idle),o(this,k,0),o(this,b,new v(n(this,w)))}}]),t}();function V(t){if(n(this,A)===U.STATUSES.playing){var e=t(),r=e.newState,a=e.mergedValues;JSON.stringify(r)!==JSON.stringify(n(this,b).getState())&&(o(this,k,n(this,k)+a.reduce(function(t,e){return t+e},0)),o(this,b,new v(r)),s(this,E,O).call(this),s(this,T,W).call(this),s(this,L,x).call(this))}}function W(){n(this,b).getState().flat().find(function(t){return 2048===t})&&o(this,A,U.STATUSES.win)}function x(){var t=this,e=n(this,b).getState();["getMovedUpState","getMovedRightState","getMovedLeftState","getMovedDownState"].some(function(r){var a=n(t,b)[r]().newState;return JSON.stringify(e)!==JSON.stringify(a)})||o(this,A,U.STATUSES.lose)}function O(){if(n(this,A)===U.STATUSES.playing){var t=n(this,b).filterCells(function(t){return 0===t});if(0!==t.length){var e=t[m(t.length)],r=e.x,a=e.y,i=n(this,b).getState();i[a][r]=0===m(10)?4:2,o(this,b,new v(i))}}}f(U,"STATUSES",{idle:"idle",playing:"playing",lose:"lose",win:"win"}),t=U;var q={};q=function(t,e,r){var n;for(var a in t)t[a].classList.contains(r)||t[a].classList.add(r);null===(n=t[e])||void 0===n||n.classList.remove(r)};var j={};j=function(t,e){for(var r in t)for(var n in t[r]){var a=e[r*t.length+ +n],i=t[r][n];a.innerHTML=i,a.className="field-cell field-cell--"+i}};var D="hidden",R={start:document.querySelector(".button.start"),restart:document.querySelector(".button.restart")},C={lose:document.querySelector(".message.message-lose"),win:document.querySelector(".message.message-win"),idle:document.querySelector(".message.message-start")},N=document.querySelector(".game-score"),I=document.querySelectorAll(".field-cell"),J=new t;R.start.addEventListener("click",function(){R.start.classList.add(D),R.restart.classList.remove(D),J.start(),j(J.getState(),I),q(C,J.getStatus(),D)}),R.restart.addEventListener("click",function(){R.restart.classList.add(D),R.start.classList.remove(D),J.restart(),j(J.getState(),I),q(C,J.getStatus(),D),N.innerHTML=J.getScore()}),document.addEventListener("keydown",function(t){switch(t.code){case"ArrowDown":J.moveDown();break;case"ArrowUp":J.moveUp();break;case"ArrowLeft":J.moveLeft();break;case"ArrowRight":J.moveRight()}N.innerHTML=J.getScore(),q(C,J.getStatus(),D),j(J.getState(),I)})}();
//# sourceMappingURL=index.1f9d8f2b.js.map
