var t={},e={};e=class{static SIZE=4;#t;constructor(t){this.#t=t}filterCells(t){let e=[],s=this.getState();for(let r in s)for(let a in s[r]){let i={x:a,y:r};t(s[r][a],i,s)&&e.push(i)}return e}getState(){return[...this.#t].map(t=>[...t])}getMovedLeftState(){let t=[],e=[];for(let s of this.getState()){let{mergedValues:r,newAxis:a}=this.#e(s);t.push(a),e.push(...r)}return{newState:t,mergedValues:e}}getMovedRightState(){let t=[],e=[];for(let s of this.getState()){let{mergedValues:r,newAxis:a}=this.#e(s.reverse());t.push(a.reverse()),e.push(...r)}return{newState:t,mergedValues:e}}getMovedUpState(){let t=this.getState(),e=[];for(let s in t){let r=[];for(let e in t[s])r.push(t[e][s]);let{mergedValues:a,newAxis:i}=this.#e(r);for(let e in t[s])t[e][s]=i[e];e.push(...a)}return{newState:t,mergedValues:e}}getMovedDownState(){let t=this.getState().reverse(),e=[];for(let s in t){let r=[];for(let e in t[s])r.push(t[e][s]);let{mergedValues:a,newAxis:i}=this.#e(r);for(let e in t[s])t[e][s]=i[e];e.push(...a)}return{newState:t.reverse(),mergedValues:e}}#e(t){let e=t.filter(t=>0!==t),s=[],r=[];for(let t=0;t<e.length;t++){let a=e[t],i=e[t+1];a===i&&(a+=i,r.push(a),t++),s.push(a)}for(;s.length<t.length;)s.push(0);return{newAxis:s,mergedValues:r}}};var s={};s=function(t,e=0){return Math.floor(Math.random()*(t-e))+e};class r{static STATUSES={idle:"idle",playing:"playing",lose:"lose",win:"win"};#s=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]];#r;#a;#i;constructor(t){this.#s=t??this.#s,this.restart()}moveLeft(){this.#o(()=>this.#r.getMovedLeftState())}moveRight(){this.#o(()=>this.#r.getMovedRightState())}moveUp(){this.#o(()=>this.#r.getMovedUpState())}moveDown(){this.#o(()=>this.#r.getMovedDownState())}getScore(){return this.#a}getState(){return this.#r.getState()}getStatus(){return this.#i}start(){this.#i=r.STATUSES.playing;for(let t=2;t>0;t--)this.#l()}restart(){this.#i=r.STATUSES.idle,this.#a=0,this.#r=new e(this.#s)}#o(t){if(this.#i!==r.STATUSES.playing)return;let{newState:s,mergedValues:a}=t();JSON.stringify(s)!==JSON.stringify(this.#r.getState())&&(this.#a+=a.reduce((t,e)=>t+e,0),this.#r=new e(s),this.#l(),this.#n(),this.#h())}#n(){this.#r.getState().flat().find(t=>2048===t)&&(this.#i=r.STATUSES.win)}#h(){let t=this.#r.getState();["getMovedUpState","getMovedRightState","getMovedLeftState","getMovedDownState"].some(e=>{let{newState:s}=this.#r[e]();return JSON.stringify(t)!==JSON.stringify(s)})||(this.#i=r.STATUSES.lose)}#l(){if(this.#i!==r.STATUSES.playing)return;let t=this.#r.filterCells(t=>0===t);if(0===t.length)return;let{x:a,y:i}=t[s(t.length)],o=this.#r.getState();o[i][a]=0===s(10)?4:2,this.#r=new e(o)}}t=r;var a={};a=function(t,e,s){for(let e in t)t[e].classList.contains(s)||t[e].classList.add(s);t[e]?.classList.remove(s)};var i={};i=function(t,e){for(let s in t)for(let r in t[s]){let a=e[s*t.length+ +r],i=t[s][r];a.innerHTML=i,a.className="field-cell field-cell--"+i}};const o="hidden",l={start:document.querySelector(".button.start"),restart:document.querySelector(".button.restart")},n={lose:document.querySelector(".message.message-lose"),win:document.querySelector(".message.message-win"),idle:document.querySelector(".message.message-start")},h=document.querySelector(".game-score"),S=document.querySelectorAll(".field-cell"),d=new t;l.start.addEventListener("click",()=>{l.start.classList.add(o),l.restart.classList.remove(o),d.start(),i(d.getState(),S),a(n,d.getStatus(),o)}),l.restart.addEventListener("click",()=>{l.restart.classList.add(o),l.start.classList.remove(o),d.restart(),i(d.getState(),S),a(n,d.getStatus(),o),h.innerHTML=d.getScore()}),document.addEventListener("keydown",t=>{switch(t.code){case"ArrowDown":d.moveDown();break;case"ArrowUp":d.moveUp();break;case"ArrowLeft":d.moveLeft();break;case"ArrowRight":d.moveRight()}h.innerHTML=d.getScore(),a(n,d.getStatus(),o),i(d.getState(),S)});
//# sourceMappingURL=index.c3e9fb10.js.map
